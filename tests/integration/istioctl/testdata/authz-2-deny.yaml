apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
 name: deny-policy-1
spec:
 action: DENY
 rules:
 - from:
   - source:
       principals: ["cluster.local/ns/default/sa/sleep"]
   to:
   - operation:
       methods: ["GET"]
   when:
   - key: request.headers[version]
     values: ["v1", "v2"]
 - to:
   - operation:
       paths: ["/abc", "/bcd"]
---
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
 name: deny-policy-2
spec:
 action: DENY
 rules:
 - from:
   - source:
       principals: ["cluster.local/ns/default/sa/sleep"]
   to:
   - operation:
       methods: ["POST"]
   when:
   - key: request.headers[version]
     values: ["v1", "v2"]
 - to:
   - operation:
       paths: ["/abc", "/bcd"]